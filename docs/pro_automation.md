# Документація модуля pro_automation

Цей модуль надає функції для автоматизації дій у системі Windows, включаючи роботу з вікнами, введенням (миша/клавіатура), гарячими клавішами та системними налаштуваннями.

## Зміст
1. [Гарячі клавіші (Hotkeys)](#гарячі-клавіші-hotkeys)
2. [Робота з вікнами (Windows)](#робота-з-вікнами-windows)
3. [Введення та миша (Input)](#введення-та-миша-input)
4. [Системні функції (System)](#системні-функції-system)

---

## Гарячі клавіші (Hotkeys)

### `register_hotkey(hotkey_str, callback)`
Реєструє глобальну гарячу клавішу в системі.
- **Аргументи:**
  - `hotkey_str` (str): Рядок комбінації клавіш (наприклад, `"Ctrl+Alt+S"`, `"Win+Space"`, `"Shift+F10"`).
  - `callback` (function): Функція, яка буде викликана при натисканні.
- **Повертає:** `id` (int) гарячої клавіші для подальшого скасування, або `False` у разі помилки.

### `unregister_hotkey(id)`
Скасовує реєстрацію гарячої клавіші.
- **Аргументи:**
  - `id` (int): Ідентифікатор, отриманий при реєстрації.
- **Повертає:** `True` (bool) якщо успішно, інакше `False`.

---

## Робота з вікнами (Windows)

### `find_windows(title_part="")`
Шукає всі видимі вікна, заголовок яких містить вказаний рядок.
- **Аргументи:**
  - `title_part` (str): Частина заголовка вікна (регістр неважливий).
- **Повертає:** `list` зі списком дескрипторів вікон (`HWND`).

### `wait_for_window(title_part, timeout_ms=5000)`
Очікує появи вікна протягом вказаного часу.
- **Аргументи:**
  - `title_part` (str): Частина заголовка вікна.
  - `timeout_ms` (int): Час очікування в мілісекундах.
- **Повертає:** `HWND` (int) знайденого вікна або `0`, якщо час вичерпано.

### `get_window_title(hwnd)`
Отримує повний заголовок вікна за його дескриптором.
- **Аргументи:**
  - `hwnd` (int): Дескриптор вікна.
- **Повертає:** `str` із заголовком вікна.

### `get_foreground_window()`
Отримує дескриптор вікна, яке зараз знаходиться на передньому плані.
- **Повертає:** `HWND` (int).

### `get_active_window_title()`
Отримує заголовок активного вікна.
- **Повертає:** `str` із заголовком.

### `activate_window(hwnd)`
Активує вказане вікно (виводить на передній план).
- **Аргументи:**
  - `hwnd` (int): Дескриптор вікна.
- **Повертає:** `True` (bool).

### `move_window(hwnd, x, y, w, h)`
Змінює позицію та розмір вікна.
- **Аргументи:** `hwnd`, `x`, `y`, `w`, `h` (всі int).
- **Повертає:** `True` (bool) якщо успішно.

### `close_window(hwnd)`
Надсилає команду закриття вікну.
- **Аргументи:** `hwnd` (int).
- **Повертає:** `True` (bool).

### `get_window_rect(hwnd)`
Отримує координати та розміри вікна.
- **Аргументи:** `hwnd` (int).
- **Повертає:** `tuple` формату `(x, y, width, height)`.

### `maximize_window(hwnd)` / `minimize_window(hwnd)`
Розгортає або згортає вікно.
- **Аргументи:** `hwnd` (int).
- **Повертає:** `True` (bool).

---

## Введення та миша (Input)

### `get_mouse_pos()` / `get_mouse_position()`
Отримує поточні координати курсору миші.
- **Повертає:** `tuple` формату `(x, y)`.

### `get_screen_size()`
Отримує розмір екрана в пікселях.
- **Повертає:** `tuple` формату `(width, height)`.

### `set_mouse_pos(x, y)`
Миттєво встановлює курсор миші у вказані координати.
- **Аргументи:** `x`, `y` (int).
- **Повертає:** `True` (bool).

### `clamp_to_screen(x, y)`
Обмежує координати межами екрана.
- **Аргументи:** `x`, `y` (int).
- **Повертає:** `tuple` формату `(cx, cy)`.

### `mouse_move_to(x, y, smooth=False, duration=0.5, steps=20)`
Переміщує мишу до цілі.
- **Аргументи:**
  - `x`, `y` (int): Координати.
  - `smooth` (bool): Якщо `True`, переміщення буде плавним.
  - `duration` (float): Тривалість руху в секундах.
  - `steps` (int): Кількість кроків для плавного руху.
- **Повертає:** `True` (bool).

### `move_mouse_relative_smooth(dx, dy, duration=0.5, steps=20)`
Плавно переміщує мишу відносно поточної позиції.
- **Аргументи:** `dx`, `dy` (зсув), `duration`, `steps`.

### `move_mouse_to_ratio(rx, ry, duration=0.5, steps=20)`
Переміщує мишу за відносними координатами екрана (0.0 - 1.0).
- **Аргументи:** `rx`, `ry` (float від 0 до 1).

### `move_mouse_bezier_to(x, y, duration=0.8, steps=40, c1=None, c2=None, jitter=0)`
Переміщує мишу по кривій Без'є для більш "людського" вигляду.

### `click(button="left", x=None, y=None, count=1, interval=0.05, smooth=False, duration=0.2, steps=15)`
Виконує натискання кнопки миші. Можна вказати координати та кількість кліків.

### `double_click(x=None, y=None, button='left', smooth=False)`
Виконує подвійний клік.

### `mouse_down(button='left')` / `mouse_up(button='left')`
Затискає або відпускає кнопку миші.

### `drag_to_smooth(x, y, duration=0.5, steps=20, button='left')`
Перетягує об'єкт у вказані координати.

### `mouse_scroll(amount, direction='vertical')`
Прокручує коліщатко миші.

### `scroll_smooth(clicks, duration=0.5, steps=10, direction='vertical')`
Плавне прокручування.

### `key_press(vk)` / `key_down(vk)` / `key_up(vk)`
Робота з клавішами за їх віртуальними кодами (VK).
- **Аргументи:** `vk` (int) — код клавіші.

### `hotkey(*vks)`
Натискає комбінацію клавіш послідовно (наприклад, Ctrl, потім C, потім відпускає обидві).
- **Аргументи:** довільна кількість `vk` кодів.

### `type_text(text, interval=0.01)`
Вводить вказаний текст (імітує натискання клавіш).
- **Аргументи:** `text` (str), `interval` (float).

### `type_text_human(text, min_interval=0.01, max_interval=0.05)`
Вводить текст з випадковими затримками, імітуючи людину.

### `wait_for_key(target_key=None, timeout=None)`
Очікує натискання клавіші.
- **Аргументи:** `target_key` (str, optional), `timeout` (float, optional).
- **Повертає:** Назву натиснутої клавіші або `None`.

### `get_pixel_color(x, y)`
Отримує колір пікселя на екрані.
- **Аргументи:** `x`, `y` (int).
- **Повертає:** `tuple` формату `(R, G, B)`.

---

## Системні функції (System)

### `sleep(ms)`
Призупиняє виконання програми.
- **Аргументи:** `ms` (int) — мілісекунди.

### `beep(freq, duration)`
Відтворює системний звуковий сигнал.
- **Аргументи:** `freq` (int) — частота в Гц, `duration` (int) — тривалість у мс.

### `set_brightness(level)` / `get_brightness()`
Встановлює або отримує яскравість монітора.
- **Аргументи:** `level` (int) від 0 до 100.
- **Повертає:** Значення яскравості (int) або статус успіху.

### `set_volume(level)` / `get_volume()`
Встановлює або отримує системну гучність.
- **Аргументи:** `level` (int) від 0 до 100.
- **Повертає:** Поточна гучність (int) або статус успіху.
- *Примітка: `get_volume` використовує сучасний Core Audio API (WASAPI).*

### `monitor_on()` / `monitor_off()`
Керує живленням монітора.
- **Повертає:** `True` (bool).

### `set_keyboard_layout(lang_id)`
Змінює мову введення.
- **Аргументи:** `lang_id` (str) — наприклад `"en"`, `"uk"` або hex-код `"00000409"`.
- **Повертає:** `True` (bool).

### `get_keyboard_layout()`
Отримує ID поточної розкладки клавіатури.
- **Повертає:** `str` (hex-код розкладки).
